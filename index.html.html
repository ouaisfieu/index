<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Knowledge Graph - RÃ©pertoire</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/d3/7.8.5/d3.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/marked/11.1.1/marked.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --green-light: #a8e6a3;
            --green-soft: #c3f0c0;
            --green-pale: #e8f5e8;
            --lilac: #c8a2c8;
            --lilac-light: #dcc7dc;
            --lilac-pale: #f3ebf3;
            --dark-green: #4a7c59;
            --dark-lilac: #8b5a8c;
            --text-primary: #2d3436;
            --text-secondary: #636e72;
            --bg-primary: #fafafa;
            --bg-secondary: #ffffff;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, sans-serif;
            background: linear-gradient(135deg, var(--green-pale) 0%, var(--lilac-pale) 100%);
            color: var(--text-primary);
            height: 100vh;
            overflow: hidden;
        }

        .container {
            display: flex;
            height: 100vh;
            position: relative;
        }

        /* Header */
        .header {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 60px;
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-bottom: 1px solid rgba(200, 162, 200, 0.2);
            display: flex;
            align-items: center;
            padding: 0 20px;
            z-index: 1000;
            box-shadow: 0 2px 10px rgba(200, 162, 200, 0.1);
        }

        .logo {
            font-size: 1.4em;
            font-weight: 700;
            background: linear-gradient(135deg, var(--dark-green), var(--dark-lilac));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            margin-right: 30px;
        }

        .search-container {
            flex: 1;
            max-width: 400px;
        }

        .search-input {
            width: 100%;
            padding: 8px 16px;
            border: 2px solid var(--green-light);
            border-radius: 20px;
            font-size: 14px;
            transition: all 0.3s ease;
            background: white;
        }

        .search-input:focus {
            outline: none;
            border-color: var(--lilac);
            box-shadow: 0 0 0 3px rgba(200, 162, 200, 0.1);
        }

        .view-toggle {
            display: flex;
            gap: 10px;
            margin-left: auto;
        }

        .toggle-btn {
            padding: 8px 16px;
            border: none;
            border-radius: 20px;
            background: var(--green-light);
            color: var(--dark-green);
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: 600;
            font-size: 14px;
        }

        .toggle-btn.active {
            background: var(--lilac);
            color: var(--dark-lilac);
        }

        .toggle-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
        }

        /* Main Content Area */
        .main-content {
            display: flex;
            width: 100%;
            height: calc(100vh - 60px);
            margin-top: 60px;
        }

        /* Graph Container */
        .graph-container {
            flex: 1;
            position: relative;
            background: rgba(255, 255, 255, 0.7);
            backdrop-filter: blur(10px);
        }

        #graph {
            width: 100%;
            height: 100%;
        }

        .graph-controls {
            position: absolute;
            bottom: 20px;
            left: 20px;
            display: flex;
            gap: 10px;
        }

        .control-btn {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            border: none;
            background: white;
            color: var(--dark-green);
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 20px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
            transition: all 0.3s ease;
        }

        .control-btn:hover {
            background: var(--green-light);
            transform: scale(1.1);
        }

        /* Sidebar */
        .sidebar {
            width: 400px;
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-left: 1px solid rgba(200, 162, 200, 0.2);
            display: flex;
            flex-direction: column;
            transition: transform 0.3s ease;
        }

        .sidebar.hidden {
            transform: translateX(100%);
        }

        .sidebar-header {
            padding: 20px;
            border-bottom: 1px solid rgba(200, 162, 200, 0.2);
            background: linear-gradient(135deg, var(--green-pale), var(--lilac-pale));
        }

        .note-title {
            font-size: 1.5em;
            font-weight: 700;
            color: var(--text-primary);
            margin-bottom: 8px;
        }

        .note-tags {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
        }

        .tag {
            padding: 4px 12px;
            background: var(--lilac-light);
            color: var(--dark-lilac);
            border-radius: 12px;
            font-size: 12px;
            font-weight: 600;
        }

        .sidebar-content {
            flex: 1;
            overflow-y: auto;
            padding: 20px;
        }

        .markdown-content {
            line-height: 1.6;
        }

        .markdown-content h1,
        .markdown-content h2,
        .markdown-content h3 {
            margin-top: 1.5em;
            margin-bottom: 0.5em;
            color: var(--dark-green);
        }

        .markdown-content p {
            margin-bottom: 1em;
            color: var(--text-secondary);
        }

        .markdown-content a {
            color: var(--dark-lilac);
            text-decoration: none;
            border-bottom: 1px dashed var(--lilac);
            transition: all 0.3s ease;
        }

        .markdown-content a:hover {
            color: var(--dark-green);
            border-color: var(--green-light);
        }

        .markdown-content code {
            background: var(--green-pale);
            padding: 2px 6px;
            border-radius: 4px;
            font-size: 0.9em;
            color: var(--dark-green);
        }

        .markdown-content blockquote {
            border-left: 4px solid var(--lilac);
            padding-left: 16px;
            margin: 1em 0;
            color: var(--text-secondary);
            font-style: italic;
        }

        /* Links Section */
        .links-section {
            margin-top: 30px;
            padding-top: 20px;
            border-top: 1px solid rgba(200, 162, 200, 0.2);
        }

        .links-title {
            font-size: 1.1em;
            font-weight: 600;
            color: var(--dark-green);
            margin-bottom: 12px;
        }

        .link-item {
            padding: 8px 12px;
            margin-bottom: 8px;
            background: var(--green-pale);
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .link-item:hover {
            background: var(--lilac-pale);
            transform: translateX(4px);
        }

        /* Node styles */
        .node {
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .node:hover {
            filter: brightness(1.2);
        }

        .node-label {
            font-size: 12px;
            font-weight: 600;
            pointer-events: none;
            user-select: none;
        }

        .link {
            stroke: var(--lilac);
            stroke-opacity: 0.4;
            stroke-width: 2;
            transition: all 0.3s ease;
        }

        .link:hover {
            stroke-opacity: 0.8;
            stroke-width: 3;
        }

        /* Tooltip */
        .tooltip {
            position: absolute;
            padding: 8px 12px;
            background: white;
            border: 2px solid var(--green-light);
            border-radius: 8px;
            font-size: 14px;
            pointer-events: none;
            opacity: 0;
            transition: opacity 0.3s ease;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
        }

        /* Mobile responsive */
        @media (max-width: 768px) {
            .sidebar {
                position: absolute;
                right: 0;
                top: 60px;
                height: calc(100vh - 60px);
                width: 100%;
                z-index: 999;
            }
            
            .header {
                padding: 0 10px;
            }
            
            .logo {
                font-size: 1.2em;
                margin-right: 15px;
            }
            
            .view-toggle {
                display: none;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header class="header">
            <div class="logo">ðŸ“Š Knowledge Graph</div>
            <div class="search-container">
                <input type="text" class="search-input" id="searchInput" placeholder="Rechercher une entitÃ©...">
            </div>
            <div class="view-toggle">
                <button class="toggle-btn active" id="graphViewBtn">Graph</button>
                <button class="toggle-btn" id="listViewBtn">Liste</button>
            </div>
        </header>

        <div class="main-content">
            <div class="graph-container">
                <svg id="graph"></svg>
                <div class="graph-controls">
                    <button class="control-btn" id="zoomIn">+</button>
                    <button class="control-btn" id="zoomOut">âˆ’</button>
                    <button class="control-btn" id="resetView">âŸ²</button>
                </div>
            </div>

            <div class="sidebar" id="sidebar">
                <div class="sidebar-header">
                    <h2 class="note-title" id="noteTitle">SÃ©lectionnez une note</h2>
                    <div class="note-tags" id="noteTags"></div>
                </div>
                <div class="sidebar-content">
                    <div class="markdown-content" id="markdownContent">
                        <p>Cliquez sur un nÅ“ud dans le graphe pour afficher le contenu de la note.</p>
                    </div>
                    <div class="links-section" id="linksSection" style="display: none;">
                        <h3 class="links-title">Connexions</h3>
                        <div id="linksList"></div>
                    </div>
                </div>
            </div>
        </div>

        <div class="tooltip" id="tooltip"></div>
    </div>

    <script>
        // Sample data - Ã€ remplacer par vos vraies donnÃ©es
        const notesData = {
            nodes: [
                {
                    id: "note1",
                    title: "Intelligence Artificielle",
                    tags: ["Technologie", "Innovation"],
                    content: "# Intelligence Artificielle\n\nL'**intelligence artificielle** (IA) est une technologie rÃ©volutionnaire qui simule l'intelligence humaine.\n\n## Applications principales\n\n- Apprentissage automatique\n- Traitement du langage naturel\n- Vision par ordinateur\n- Robotique\n\n> \"L'IA est la nouvelle Ã©lectricitÃ©\" - Andrew Ng\n\n## Liens avec d'autres domaines\n\nL'IA est Ã©troitement liÃ©e au [[Machine Learning]] et aux [[RÃ©seaux de neurones]].",
                    links: ["note2", "note3"]
                },
                {
                    id: "note2",
                    title: "Machine Learning",
                    tags: ["IA", "Algorithmes"],
                    content: "# Machine Learning\n\nLe **Machine Learning** est une branche de l'[[Intelligence Artificielle]] qui permet aux systÃ¨mes d'apprendre automatiquement.\n\n## Types d'apprentissage\n\n1. **SupervisÃ©** : Avec des donnÃ©es Ã©tiquetÃ©es\n2. **Non supervisÃ©** : Sans Ã©tiquettes\n3. **Par renforcement** : Par essai-erreur\n\n## Frameworks populaires\n\n- `TensorFlow`\n- `PyTorch`\n- `Scikit-learn`",
                    links: ["note1", "note3", "note4"]
                },
                {
                    id: "note3",
                    title: "RÃ©seaux de neurones",
                    tags: ["IA", "Deep Learning"],
                    content: "# RÃ©seaux de neurones\n\nLes **rÃ©seaux de neurones** sont inspirÃ©s du cerveau humain et constituent la base du [[Deep Learning]].\n\n## Architecture\n\n- Couche d'entrÃ©e\n- Couches cachÃ©es\n- Couche de sortie\n\n## Applications\n\nLes rÃ©seaux de neurones excellent dans:\n- La reconnaissance d'images\n- Le traitement du langage\n- La prÃ©diction de sÃ©ries temporelles",
                    links: ["note1", "note2", "note5"]
                },
                {
                    id: "note4",
                    title: "Data Science",
                    tags: ["DonnÃ©es", "Analyse"],
                    content: "# Data Science\n\nLa **Data Science** combine statistiques, programmation et expertise mÃ©tier pour extraire de la valeur des donnÃ©es.\n\n## Processus\n\n1. Collecte de donnÃ©es\n2. Nettoyage et prÃ©paration\n3. Analyse exploratoire\n4. ModÃ©lisation\n5. Visualisation\n\n## Outils essentiels\n\n- `Python` et `R`\n- `Jupyter Notebooks`\n- `SQL`\n\nLa Data Science utilise beaucoup le [[Machine Learning]] pour crÃ©er des modÃ¨les prÃ©dictifs.",
                    links: ["note2", "note6"]
                },
                {
                    id: "note5",
                    title: "Deep Learning",
                    tags: ["IA", "Neural Networks"],
                    content: "# Deep Learning\n\nLe **Deep Learning** utilise des [[RÃ©seaux de neurones]] profonds pour rÃ©soudre des problÃ¨mes complexes.\n\n## Architectures cÃ©lÃ¨bres\n\n- **CNN** : Pour la vision\n- **RNN** : Pour les sÃ©quences\n- **Transformer** : Pour le NLP moderne\n\n## RÃ©volutions rÃ©centes\n\n- GPT et les LLMs\n- DALL-E et la gÃ©nÃ©ration d'images\n- AlphaFold et la biologie",
                    links: ["note3", "note6"]
                },
                {
                    id: "note6",
                    title: "Big Data",
                    tags: ["DonnÃ©es", "Infrastructure"],
                    content: "# Big Data\n\nLe **Big Data** dÃ©signe des ensembles de donnÃ©es trop volumineux pour les outils traditionnels.\n\n## Les 3V\n\n- **Volume** : QuantitÃ© massive\n- **VÃ©locitÃ©** : Vitesse de gÃ©nÃ©ration\n- **VariÃ©tÃ©** : Types diffÃ©rents\n\n## Technologies clÃ©s\n\n- Apache Hadoop\n- Apache Spark\n- NoSQL databases\n\nLe Big Data alimente la [[Data Science]] et le [[Deep Learning]].",
                    links: ["note4", "note5"]
                }
            ]
        };

        // Convert nodes array to links format for D3
        const links = [];
        notesData.nodes.forEach(node => {
            if (node.links) {
                node.links.forEach(targetId => {
                    links.push({
                        source: node.id,
                        target: targetId
                    });
                });
            }
        });

        // Initialize D3 Graph
        const width = window.innerWidth;
        const height = window.innerHeight - 60;

        const svg = d3.select("#graph")
            .attr("width", width)
            .attr("height", height);

        const g = svg.append("g");

        // Zoom behavior
        const zoom = d3.zoom()
            .scaleExtent([0.1, 4])
            .on("zoom", (event) => {
                g.attr("transform", event.transform);
            });

        svg.call(zoom);

        // Force simulation
        const simulation = d3.forceSimulation(notesData.nodes)
            .force("link", d3.forceLink(links).id(d => d.id).distance(150))
            .force("charge", d3.forceManyBody().strength(-300))
            .force("center", d3.forceCenter(width / 2, height / 2))
            .force("collision", d3.forceCollide().radius(50));

        // Create links
        const link = g.append("g")
            .selectAll("line")
            .data(links)
            .enter().append("line")
            .attr("class", "link");

        // Create nodes
        const node = g.append("g")
            .selectAll("g")
            .data(notesData.nodes)
            .enter().append("g")
            .attr("class", "node")
            .call(d3.drag()
                .on("start", dragstarted)
                .on("drag", dragged)
                .on("end", dragended));

        // Add circles to nodes
        node.append("circle")
            .attr("r", 25)
            .attr("fill", d => {
                const colors = ["#a8e6a3", "#c8a2c8", "#b8d4e3", "#ffc09f", "#ffee93"];
                return colors[d.id.charCodeAt(d.id.length - 1) % colors.length];
            })
            .attr("stroke", "#fff")
            .attr("stroke-width", 3);

        // Add labels to nodes
        node.append("text")
            .attr("class", "node-label")
            .attr("text-anchor", "middle")
            .attr("dy", "0.3em")
            .text(d => d.title)
            .style("fill", "#2d3436")
            .style("font-size", "10px");

        // Node click event
        node.on("click", function(event, d) {
            displayNote(d);
        });

        // Node hover events
        node.on("mouseenter", function(event, d) {
            const tooltip = document.getElementById("tooltip");
            tooltip.style.opacity = 1;
            tooltip.style.left = event.pageX + 10 + "px";
            tooltip.style.top = event.pageY - 10 + "px";
            tooltip.innerHTML = `<strong>${d.title}</strong><br>Tags: ${d.tags.join(", ")}`;
        });

        node.on("mouseleave", function() {
            document.getElementById("tooltip").style.opacity = 0;
        });

        // Update positions on simulation tick
        simulation.on("tick", () => {
            link
                .attr("x1", d => d.source.x)
                .attr("y1", d => d.source.y)
                .attr("x2", d => d.target.x)
                .attr("y2", d => d.target.y);

            node
                .attr("transform", d => `translate(${d.x},${d.y})`);
        });

        // Drag functions
        function dragstarted(event, d) {
            if (!event.active) simulation.alphaTarget(0.3).restart();
            d.fx = d.x;
            d.fy = d.y;
        }

        function dragged(event, d) {
            d.fx = event.x;
            d.fy = event.y;
        }

        function dragended(event, d) {
            if (!event.active) simulation.alphaTarget(0);
            d.fx = null;
            d.fy = null;
        }

        // Display note in sidebar
        function displayNote(noteData) {
            document.getElementById("noteTitle").textContent = noteData.title;
            
            // Display tags
            const tagsContainer = document.getElementById("noteTags");
            tagsContainer.innerHTML = "";
            noteData.tags.forEach(tag => {
                const tagElement = document.createElement("span");
                tagElement.className = "tag";
                tagElement.textContent = tag;
                tagsContainer.appendChild(tagElement);
            });
            
            // Render markdown content
            const markdownContent = document.getElementById("markdownContent");
            markdownContent.innerHTML = marked.parse(noteData.content);
            
            // Display links
            if (noteData.links && noteData.links.length > 0) {
                document.getElementById("linksSection").style.display = "block";
                const linksList = document.getElementById("linksList");
                linksList.innerHTML = "";
                
                noteData.links.forEach(linkId => {
                    const linkedNote = notesData.nodes.find(n => n.id === linkId);
                    if (linkedNote) {
                        const linkItem = document.createElement("div");
                        linkItem.className = "link-item";
                        linkItem.textContent = linkedNote.title;
                        linkItem.onclick = () => displayNote(linkedNote);
                        linksList.appendChild(linkItem);
                    }
                });
            } else {
                document.getElementById("linksSection").style.display = "none";
            }
            
            // Show sidebar if hidden on mobile
            document.getElementById("sidebar").classList.remove("hidden");
        }

        // Search functionality
        document.getElementById("searchInput").addEventListener("input", function(e) {
            const searchTerm = e.target.value.toLowerCase();
            
            node.style("opacity", d => {
                const matchTitle = d.title.toLowerCase().includes(searchTerm);
                const matchTags = d.tags.some(tag => tag.toLowerCase().includes(searchTerm));
                return (matchTitle || matchTags || searchTerm === "") ? 1 : 0.2;
            });
            
            link.style("opacity", d => {
                const sourceMatch = d.source.title.toLowerCase().includes(searchTerm);
                const targetMatch = d.target.title.toLowerCase().includes(searchTerm);
                return (sourceMatch || targetMatch || searchTerm === "") ? 0.4 : 0.05;
            });
        });

        // Zoom controls
        document.getElementById("zoomIn").addEventListener("click", () => {
            svg.transition().duration(300).call(zoom.scaleBy, 1.3);
        });

        document.getElementById("zoomOut").addEventListener("click", () => {
            svg.transition().duration(300).call(zoom.scaleBy, 0.7);
        });

        document.getElementById("resetView").addEventListener("click", () => {
            svg.transition().duration(300).call(
                zoom.transform,
                d3.zoomIdentity.translate(width / 2, height / 2).scale(1)
            );
            simulation.alpha(0.3).restart();
        });

        // View toggle (Graph/List view)
        document.getElementById("graphViewBtn").addEventListener("click", function() {
            this.classList.add("active");
            document.getElementById("listViewBtn").classList.remove("active");
            // Graph view logic here
        });

        document.getElementById("listViewBtn").addEventListener("click", function() {
            this.classList.add("active");
            document.getElementById("graphViewBtn").classList.remove("active");
            // List view logic here (Ã  implÃ©menter)
        });

        // Responsive handling
        window.addEventListener("resize", () => {
            const newWidth = window.innerWidth;
            const newHeight = window.innerHeight - 60;
            
            svg.attr("width", newWidth).attr("height", newHeight);
            simulation.force("center", d3.forceCenter(newWidth / 2, newHeight / 2));
            simulation.alpha(0.3).restart();
        });
    </script>
</body>
</html>